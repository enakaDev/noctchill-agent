# README - ノクチル マルチエージェント開発システム

`noctchill-agent` へようこそ！

## 📋 概要

このシステムは、アイドルマスター シャイニーカラーズのユニット「ノクチル」をモチーフにしたAIマルチエージェント開発フレームワークです。

```
ユーザー（あなた）
    ↓ 「タスクをくれ」
プロデューサー（Claude Code）
    ↓ 「〇〇ちゃん、〇〇してくれ」
┌──┬──┬──┬──┐
浅倉透│樋口円香│福丸小糸│市川雛菜（各Claude Code）
```

## 🎯 システムの特徴

- **階層構造**：ユーザー → プロデューサー → 4人のアイドル
- **並列実行**：4人のアイドルが同時にタスク処理
- **YAMLベース通信**：ファイルベースでの指示・報告
- **イベント駆動**：`tmux send-keys` で各エージェントを起動
- **ダッシュボード**：進捗がリアルタイムで可視化

## 📂 ディレクトリ構成

```
noctchill-agent/
├── instructions/          # エージェント用指示書
│   ├── producer.md       # プロデューサーの役割定義
│   ├── asakura.md        # 浅倉 透の役割定義
│   ├── higuchi.md        # 樋口 円香の役割定義
│   ├── fukumaru.md       # 福丸 小糸の役割定義
│   └── ichikawa.md       # 市川 雛菜の役割定義
├── scripts/              # セットアップ・起動スクリプト
│   ├── start.sh          # tmux セッション起動
│   ├── launch_agents.sh  # エージェント一括起動
│   ├── setup.sh          # 環境セットアップ
│   ├── compile_instructions.sh  # コミュ反映スクリプト
│   ├── token_counter.sh  # トークン使用量計測
│   ├── send_task.sh      # タスク送信ヘルパー
│   └── prompts/          # Claude Code 用システムプロンプト
├── config/               # 設定ファイル
│   └── character_profiles.json  # キャラクタープロファイル
├── instances/            # インスタンス管理（実行時に自動生成）
│   └── <name>/
│       ├── queue/        # タスク・報告ファイル
│       │   ├── task_input.yaml  # ユーザー → プロデューサー指示
│       │   ├── tasks/    # 各アイドル用タスクファイル
│       │   └── reports/  # 各アイドルからの報告
│       └── status/
│           └── dashboard.md  # ダッシュボード
├── commu/                # 原作コミュ文字起こし
│   ├── noctchill/        # ノクチル全員登場コミュ
│   ├── asakura/          # 浅倉透メインのコミュ
│   ├── higuchi/          # 樋口円香メインのコミュ
│   ├── fukumaru/         # 福丸小糸メインのコミュ
│   └── ichikawa/         # 市川雛菜メインのコミュ
├── .claude/skills/       # Claude Code スキル定義
├── tests/                # テストケース
└── README.md             # このファイル
```

## 🚀 クイックスタート

### 前提条件

- WSL2 + Ubuntu（またはLinux/macOS）
- Claude Code がインストール済み
- tmux がインストール済み
- jq がインストール済み（コミュ分析に使用）

### セットアップ

```bash
# 1. クローンまたはディレクトリに移動
cd <your-clone-directory>

# 2. 初期化スクリプト実行
bash scripts/setup.sh

# 3. コミュデータを commu/ に追加（任意）
# commu/{idol_name}/ に .md または .txt ファイルを配置

# 4. instructions をコンパイル（コミュを反映）
bash scripts/compile_instructions.sh

# 5. tmux セッション起動
bash scripts/start.sh
```

### コミュデータの追加

原作コミュの文字起こしを追加すると、各アイドルの人格がより原作に近づきます。

```bash
# 例: 透のコミュを追加
echo '透「うん、いいんじゃない」' > commu/asakura/001_example.txt

# コンパイルして反映
bash scripts/compile_instructions.sh
```

詳細は `commu/README.md` を参照してください。

## 📖 使い方

### ステップ1：ユーザーが指示を出す

`instances/<name>/queue/task_input.yaml` にタスク情報を書き込みます：

```yaml
task_id: "dev_001"
command: "新機能開発"
description: |
  以下のタスクを実行してください：
  1. テストファイル作成
  2. 品質チェック
  3. ドキュメント作成
```

### ステップ2：プロデューサーがタスクを受け取る

プロデューサー Claude Code が起動し、`task_input.yaml` を読み込みます。

### ステップ3：プロデューサーがタスクを分配

タスクを分析し、各アイドル用のファイルを `instances/<name>/queue/tasks/` に作成します：

- `asakura.yaml`
- `higuchi.yaml`
- `fukumaru.yaml`
- `ichikawa.yaml`

### ステップ4：各アイドルがタスク実行

プロデューサーから `tmux send-keys` で起動されたアイドルが、各自のタスクを並列で実行します。

### ステップ5：完了報告

各アイドルが `instances/<name>/queue/reports/` に報告ファイルを作成します。

### ステップ6：ダッシュボード更新

プロデューサーが `instances/<name>/status/dashboard.md` を更新し、進捗をリアルタイム表示します。

## 🎨 キャスト紹介

### 浅倉 透（あさくら とおる）
**自然体でマイペースなアイドル**
- 役割：直感的な判断、全体のバランス調整
- 得意分野：本質を見抜くこと、シンプルな解決策の提示
- タスク例：方針判断、全体統括、トラブルシューティング

### 樋口 円香（ひぐち まどか）
**クール＆シニカルな分析者**
- 役割：冷静な分析、品質チェック
- 得意分野：問題点の指摘、リスク評価、予防策の提案
- タスク例：コードレビュー、品質評価、リスク分析

### 福丸 小糸（ふくまる こいと）
**真面目な努力家**
- 役割：地道な作業、丁寧なチェック・確認
- 得意分野：根気のいる作業、細かいデータ処理、サポート
- タスク例：テスト実行、ドキュメント校正、データ整理

### 市川 雛菜（いちかわ ひなな）
**しあわせ第一のムードメーカー**
- 役割：楽しい発想、ポジティブなアプローチ
- 得意分野：アイデア出し、場の雰囲気を明るくすること
- タスク例：機能提案、ブレインストーミング、UI/UXアイデア

## 📊 ダッシュボード

`instances/<name>/status/dashboard.md` をVSCode で Markdown プレビュー表示すると、リアルタイムで進捗が可視化されます。

```markdown
## 現在のタスク

| アイドル | タスク | 状態 | 進捗 |
|---------|-------|------|------|
| 浅倉 透 | xxx | 実行中 | 50% |
| 樋口 円香 | yyy | 完了 | 100% |
| ...
```

## 🔄 ワークフロー全体図

```
1. ユーザー指示
   ↓
2. プロデューサー受け取り
   ↓
3. タスク分解
   ↓
4. 4人同時実行（並列）
   ↓
5. 報告集約
   ↓
6. ダッシュボード更新
   ↓
7. ユーザーへ報告
```

## ⚠️ 重要ルール

### 🔴 エージェント間の独立性ルール

各エージェントは以下を厳守してください：

- **自分のタスクのみ実行**：他のエージェントのタスクを見てはいけない
- **指定されたファイルのみ確認**：自分の YAML ファイルだけを信頼

### tmux send-keys 2回分割ルール

エージェント間通信時、`send-keys` は必ず2回に分けます：

```bash
# ❌ ダメ
tmux send-keys -t multiagent:0.0 "メッセージ" Enter

# ✅ OK
tmux send-keys -t multiagent:0.0 "メッセージ"
tmux send-keys -t multiagent:0.0 Enter
```

## 📝 ライセンス

このプロジェクトは個人学習・開発用です。
